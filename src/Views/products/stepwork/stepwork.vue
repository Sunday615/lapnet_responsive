<script setup>
import { ref, onMounted, onBeforeUnmount } from 'vue'
import { gsap } from 'gsap'
import { ScrollTrigger } from 'gsap/ScrollTrigger'

gsap.registerPlugin(ScrollTrigger)

const section = ref(null)
let ctx = null // ‡πÄ‡∏Å‡πá‡∏ö context ‡∏Ç‡∏≠‡∏á gsap

onMounted(() => {
  ctx = gsap.context(() => {
    // TITLE
    gsap.from('.hiw-title', {
      opacity: 0,
      y: -30,
      duration: 0.8,
      ease: 'power3.out',
      scrollTrigger: {
        trigger: section.value,
        start: 'top 80%',
      },
    })

    // TIMELINE LINE
    gsap.from('.hiw-line', {
      scaleY: 0,
      transformOrigin: 'center top',
      duration: 1,
      ease: 'power3.out',
      scrollTrigger: {
        trigger: section.value,
        start: 'top 75%',
      },
    })

    // TIMELINE DOTS
    gsap.from('.hiw-dot', {
      scale: 0,
      opacity: 0,
      duration: 0.4,
      stagger: 0.15,
      ease: 'back.out(1.7)',
      scrollTrigger: {
        trigger: section.value,
        start: 'top 70%',
      },
    })

    // STEPS 1 ‚Üí 2 ‚Üí 3
    const tlSteps = gsap.timeline({
      scrollTrigger: {
        trigger: section.value,
        start: 'top 65%',
      },
    })

    tlSteps
      .from(['.hiw-step--1', '.hiw-icon-card--1'], {
        opacity: 0,
        y: 40,
        duration: 0.6,
        ease: 'power3.out',
      })
      .from('.hiw-step--2', {
        opacity: 0,
        y: 40,
        duration: 0.6,
        ease: 'power3.out',
      })
      .from(['.hiw-step--3', '.hiw-icon-card--3'], {
        opacity: 0,
        y: 40,
        duration: 0.6,
        ease: 'power3.out',
      })
  }, section)
})

onBeforeUnmount(() => {
  if (ctx) ctx.revert()
})
</script>

<template>
  <section class="hiw" ref="section">
    <div class="hiw-inner">
      <!-- TITLE -->
      <h2 class="hiw-title">
        ‡∫Ç‡∫±‡ªâ‡∫ô‡∫ï‡∫≠‡∫ô‡∫Å‡∫≤‡∫ô‡ªÇ‡∫≠‡∫ô‡ªÄ‡∫á‡∫¥‡∫ô‡∫Ç‡ªâ‡∫≤‡∫°
        <br />
        ‡∫ó‡∫∞‡∫ô‡∫≤‡∫Ñ‡∫≤‡∫ô‡∫ú‡ªà‡∫≤‡∫ô‡∫ï‡∫π‡ªâ ATM
      </h2>

      <!-- GRID -->
      <div class="hiw-layout">
        <!-- LEFT COLUMN -->
        <div class="hiw-col hiw-col--left">
          <!-- STEP 1 -->
          <div class="hiw-step hiw-step--1">
            <h3>‡∫Ç‡∫±‡ªâ‡∫ô‡∫ï‡∫≠‡∫ô‡∫ó‡∫µ 1 ‡∫à‡∫∏‡∫î‡ªÉ‡∫´‡ªâ‡∫ö‡ªç‡∫•‡∫¥‡∫Å‡∫≤‡∫ô</h3>
            <p>
              ‡∫Å‡∫≤‡∫ô‡ªÇ‡∫≠‡∫ô‡ªÄ‡∫á‡∫¥‡∫ô‡∫Ç‡ªâ‡∫≤‡∫°‡∫ó‡∫∞‡∫ô‡∫≤‡∫Ñ‡∫≤‡∫ô‡∫ú‡ªà‡∫≤‡∫ô‡∫ï‡∫π‡ªâ ATM ‡∫™‡∫≤‡∫°‡∫≤‡∫î‡ªÄ‡∫Æ‡∫±‡∫î‡∫ó‡∫∏‡∫•‡∫∞‡∫Å‡∫≥‡∫Å‡∫≤‡∫ô‡ªÇ‡∫≠‡∫ô‡ªÑ‡∫î‡ªâ‡∫ó‡∫µ‡ªà‡∫ï‡∫π‡ªâ ATM ‡∫î‡∫±‡ªà‡∫á‡∫•‡∫∏‡ªà‡∫°‡∫ô‡∫µ‡ªâ:
              <br />
              1. ‡∫ö‡∫±‡∫î ATM ‡∫Ç‡∫≠‡∫á‡∫ó‡∫∞‡∫ô‡∫≤‡∫Ñ‡∫≤‡∫ô (A) ‡∫™‡∫≤‡∫°‡∫≤‡∫î‡∫ô‡∫≥‡ªÉ‡∫ä‡ªâ‡∫ï‡∫π‡ªâ‡∫Ç‡∫≠‡∫á‡∫ó‡∫∞‡∫ô‡∫≤‡∫Ñ‡∫≤‡∫ô (A) ‡ªÄ‡∫û‡∫∑‡ªà‡∫≠‡ªÇ‡∫≠‡∫ô‡∫´‡∫≤‡∫ú‡∫π‡ªâ‡∫Æ‡∫±‡∫ö‡∫õ‡∫≤‡∫ç‡∫ó‡∫≤‡∫á‡∫ó‡∫µ‡ªà‡∫ó‡∫∞‡∫ô‡∫≤‡∫Ñ‡∫≤‡∫ô (B)
              <br />
              2. ‡∫ö‡∫±‡∫î‡∫ó‡∫∞‡∫ô‡∫≤‡∫Ñ‡∫≤‡∫ô (A) ‡∫™‡∫≤‡∫°‡∫≤‡∫î‡∫ô‡∫≥‡ªÉ‡∫ä‡ªâ‡∫ï‡∫π‡ªâ‡∫Ç‡∫≠‡∫á‡∫ó‡∫∞‡∫ô‡∫≤‡∫Ñ‡∫≤‡∫ô (B) ‡ªÄ‡∫û‡∫∑‡ªà‡∫≠‡ªÇ‡∫≠‡∫ô‡∫´‡∫≤‡∫ú‡∫π‡ªâ‡∫Æ‡∫±‡∫ö‡∫õ‡∫≤‡∫ç‡∫ó‡∫≤‡∫á‡∫ó‡∫µ‡ªà‡∫ó‡∫∞‡∫ô‡∫≤‡∫Ñ‡∫≤‡∫ô (C)
            </p>
          </div>

          <!-- SPACER (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á icon step 2) -->
          <div class="hiw-spacer"></div>

          <!-- STEP 3 -->
          <div class="hiw-step hiw-step--3">
            <h3>‡∫Ç‡∫±‡ªâ‡∫ô‡∫ï‡∫≠‡∫ô‡∫ó‡∫µ 3 ‡∫Å‡∫≤‡∫ô‡ªÄ‡∫Æ‡∫±‡∫î‡∫ó‡∫∏‡∫•‡∫∞‡∫Å‡∫≥</h3>
            <p>
              1. ‡∫ô‡∫≥‡∫ö‡∫±‡∫î‡ªÄ‡∫≠‡∫ó‡∫µ‡ªÄ‡∫≠‡∫±‡∫°‡∫õ‡ªà‡∫≠‡∫ô‡ªÄ‡∫Ç‡∫ª‡ªâ‡∫≤‡∫ï‡∫π‡ªâ‡ªÄ‡∫≠‡∫ó‡∫µ‡ªÄ‡∫≠‡∫±‡∫° ‡ªÄ‡∫Æ‡∫±‡∫î‡∫ï‡∫≤‡∫°‡∫Ç‡∫±‡ªâ‡∫ô‡∫ï‡∫≠‡∫ô‡∫Å‡∫≤‡∫ô‡ªÇ‡∫≠‡∫ô‡ªÄ‡∫á‡∫¥‡∫ô ‡ªÅ‡∫•‡∫∞
              ‡∫õ‡ªâ‡∫≠‡∫ô‡ªÄ‡∫•‡∫Å‡ªú‡ªâ‡∫≤‡∫ö‡∫±‡∫î 16 ‡ªÇ‡∫ï‡ªÄ‡∫•‡∫Å‡∫Ç‡∫≠‡∫á‡∫ú‡∫π‡ªâ‡∫Æ‡∫±‡∫ö‡∫õ‡∫≤‡∫ç‡∫ó‡∫≤‡∫á ‡∫Å‡∫ª‡∫î‡∫à‡∫≥‡∫ô‡∫ß‡∫ô‡ªÄ‡∫á‡∫¥‡∫ô ‡ªÅ‡∫•‡ªâ‡∫ß‡∫¢‡∫∑‡∫ô‡∫¢‡∫±‡∫ô
              <br />
              2. ‡∫ú‡∫π‡ªâ‡∫Æ‡∫±‡∫ö‡∫õ‡∫≤‡∫ç‡∫ó‡∫≤‡∫á‡∫à‡∫∞‡ªÑ‡∫î‡ªâ‡∫Æ‡∫±‡∫ö‡ªÄ‡∫á‡∫¥‡∫ô‡ªÇ‡∫≠‡∫ô‡∫ó‡∫±‡∫ô‡∫ó‡∫µ ‡∫´‡∫º‡∫±‡∫á‡∫à‡∫≤‡∫Å‡∫ó‡∫∏‡∫•‡∫∞‡∫Å‡∫≥‡∫Å‡∫≤‡∫ô‡ªÇ‡∫≠‡∫ô‡ªÄ‡∫á‡∫¥‡∫ô‡∫™‡∫≥‡ªÄ‡∫•‡∫±‡∫î.
            </p>
          </div>
        </div>

        <!-- CENTER COLUMN (TIMELINE) -->
        <div class="hiw-col hiw-col--center">
          <div class="hiw-timeline">
            <div class="hiw-line"></div>
            <span class="hiw-dot hiw-dot--1"></span>
            <span class="hiw-dot hiw-dot--2"></span>
            <span class="hiw-dot hiw-dot--3"></span>
          </div>
        </div>

        <!-- RIGHT COLUMN -->
        <div class="hiw-col hiw-col--right">
          <!-- ICON STEP 1 -->
          <div class="hiw-icon-card hiw-icon-card--1">
            <div class="hiw-icon">
              <img src="/logolapnet/logolapnet.PNG" alt="LAPNet logo" />
            </div>
          </div>

          <!-- STEP 2 -->
          <div class="hiw-step hiw-step--2">
            <h3>‡∫Ç‡∫±‡ªâ‡∫ô‡∫ï‡∫≠‡∫ô‡∫ó‡∫µ 2 ‡∫™‡∫∞‡∫°‡∫≤‡∫ä‡∫¥‡∫Å‡∫ó‡∫µ‡ªà‡ªÉ‡∫´‡ªâ‡∫ö‡ªç‡∫•‡∫¥‡∫Å‡∫≤‡∫ô</h3>
            <p>
              ‡∫™‡∫≤‡∫°‡∫≤‡∫î‡ªÄ‡∫•‡∫∑‡∫≠‡∫Å‡ªÉ‡∫ä‡ªâ‡∫ï‡∫π‡ªâ ATM ‡ªÉ‡∫î‡∫Å‡ªç‡ªÑ‡∫î‡ªâ ‡∫û‡∫≤‡∫ç‡ªÉ‡∫ô 16 ‡∫ó‡∫∞‡∫ô‡∫≤‡∫Ñ‡∫≤‡∫ô‡∫ó‡∫µ‡ªà‡ªÄ‡∫õ‡∫±‡∫ô‡∫™‡∫∞‡∫°‡∫≤‡∫ä‡∫¥‡∫Å‡∫Ç‡∫≠‡∫á‡∫ö‡ªç‡∫•‡∫¥‡∫™‡∫±‡∫î LAPNet
            </p>
          </div>

          <!-- ICON STEP 3 -->
          <div class="hiw-icon-card hiw-icon-card--3">
            <div class="hiw-icon">
              <img src="/logolapnet/textlogo.PNG" alt="LAPNet text logo" />
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
</template>

<style scoped>
.hiw {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  width: 100%;
  min-height: 100%; /* üîÑ was fixed 940px */
  padding: 64px 0 80px;
  overflow: hidden;
  color: #e5e7eb;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: radial-gradient(circle at top, #1871ff 0, #001261 55%, #000 100%);
  box-sizing: border-box;
}

/* glow */
.hiw::before {
  content: '';
  position: absolute;
  top: -140px;
  left: 50%;
  width: 460px;
  height: 460px;
  transform: translateX(-50%);
  border-radius: 50%;
  background: rgba(59, 130, 246, 0.7);
  filter: blur(110px);
  opacity: 0.7;
  pointer-events: none;
}

.hiw-inner {
  position: relative;
  width: 100%;
  max-width: 1120px;
  padding: 48px 32px;
}

/* TITLE */
.hiw-title {
  margin-bottom: 60px;
  text-align: center;
  font-size: clamp(2rem, 4vw, 3rem); /* üîÑ responsive font-size */
  font-weight: 700;
  line-height: 1.15;
}

/* LAYOUT */
.hiw-layout {
  display: grid;
  grid-template-columns: 1.4fr 0.2fr 1.4fr;
  column-gap: 48px;
  align-items: center;
}

/* COLUMNS */
.hiw-col--left,
.hiw-col--right {
  display: grid;
  grid-template-rows: repeat(3, minmax(0, auto));
  row-gap: 64px;
}

/* spacer */
.hiw-spacer {
  min-height: 40px;
}

/* TIMELINE */
.hiw-col--center {
  display: flex;
  justify-content: center;
}

.hiw-timeline {
  position: relative;
  width: 4px;
  height: 360px;
}

.hiw-line {
  position: absolute;
  inset: 0;
  margin: auto;
  width: 2px;
  border-radius: 999px;
  background: linear-gradient(to bottom, #1d4ed8, #38bdf8);
}

.hiw-dot {
  position: absolute;
  left: 50%;
  width: 14px;
  height: 14px;
  transform: translateX(-50%);
  border-radius: 999px;
  background: radial-gradient(circle at 30% 20%, #e0f2fe, #3b82f6);
  box-shadow: 0 0 18px rgba(37, 99, 235, 0.9);
}

.hiw-dot--1 {
  top: 0;
}

.hiw-dot--2 {
  top: 50%;
  transform: translate(-50%, -50%);
}

.hiw-dot--3 {
  bottom: 0;
}

/* STEPS TEXT */
.hiw-step h3 {
  margin-bottom: 6px;
  font-size: 22px;
  font-weight: 600;
  color: #fff36f;
}

.hiw-step p {
  font-size: 16px;
  line-height: 1.7;
  color: #feffff;
}

/* ICON CARDS */
.hiw-icon-card {
  display: flex;
  align-items: center;
  justify-content: center;
  justify-self: flex-start;
  width: 80px;
  height: 80px;
  border-radius: 24px;
  background: rgba(15, 23, 42, 0.95);
  border: 1px solid rgba(59, 130, 246, 0.7);
  box-shadow: 0 16px 40px rgba(15, 23, 42, 0.9);
}

.hiw-icon {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 56px;
  height: 56px;
  border-radius: 18px;
  background: radial-gradient(circle at 30% 20%, #e5f2ff, #3b82f6);
  font-size: 30px;
  color: #020617;
}

.hiw-icon img {
  max-width: 70%;
  max-height: 70%;
}

/* align icons */
.hiw-icon-card--1,
.hiw-icon-card--3 {
  justify-self: flex-end;
}

/* =========================
   RESPONSIVE
   ========================= */

/* Medium screens ‚Äì slightly tighter layout */
@media (max-width: 1100px) {
  .hiw-inner {
    padding: 40px 24px;
  }
  .hiw-layout {
    column-gap: 32px;
  }
  .hiw-step p {
    font-size: 15px;
  }
}

/* Tablet & down ‚Äì stack columns */
@media (max-width: 900px) {
  .hiw {
    padding: 48px 0 56px;
  }

  .hiw-inner {
    padding: 32px 20px;
  }

  .hiw-title {
    font-size: clamp(1.8rem, 5vw, 2.4rem);
    margin-bottom: 40px;
  }

  .hiw-layout {
    grid-template-columns: 1fr;
    row-gap: 32px;
  }

  .hiw-col--left,
  .hiw-col--right {
    grid-template-rows: none;
    row-gap: 32px;
  }

  .hiw-col--center {
    order: -1; /* timeline on top */
  }

  .hiw-timeline {
    height: 260px;
  }

  .hiw-icon-card {
    justify-self: flex-start; /* icons align with text */
  }
}

/* Small mobile tweaks */
@media (max-width: 600px) {
  .hiw-inner {
    padding: 24px 16px;
  }

  .hiw-title {
    margin-bottom: 32px;
  }

  .hiw-step h3 {
    font-size: 18px;
  }

  .hiw-step p {
    font-size: 14px;
    line-height: 1.6;
  }
}
</style>
